{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T&P Portal - NIT Andhra Pradesh</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --nitap-blue: #003366;
        --nitap-orange: #ff6600;
        --nitap-light: #f8f9fa;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f5f5f5;
      }

      .header {
        background: linear-gradient(
          135deg,
          var(--nitap-blue),
          var(--nitap-orange)
        );
        color: white;
        padding: 1.5rem 0;
        margin-bottom: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        font-weight: 700;
        font-size: 2.2rem;
        margin-bottom: 0.5rem;
      }

      .header h2 {
        font-weight: 500;
        font-size: 1.8rem;
      }

      .navbar {
        background-color: white !important;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        padding: 0.5rem 1rem;
      }

      .navbar-brand {
        font-weight: 600;
        color: var(--nitap-blue) !important;
        display: flex;
        align-items: center;
      }

      .navbar-brand img {
        margin-right: 10px;
      }

      .nav-link {
        font-weight: 500;
        color: #555 !important;
        padding: 0.5rem 1rem !important;
        border-radius: 4px;
        margin: 0 0.2rem;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
      }

      .nav-link i {
        margin-right: 6px;
        font-size: 0.9rem;
      }

      .nav-link:hover,
      .nav-link.active {
        background-color: rgba(0, 51, 102, 0.1);
        color: var(--nitap-blue) !important;
      }

      .dropdown-menu {
        border: none;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .dropdown-item {
        padding: 0.5rem 1.5rem;
        display: flex;
        align-items: center;
      }

      .dropdown-item i {
        margin-right: 8px;
        width: 18px;
        text-align: center;
      }

      .dropdown-item:hover {
        background-color: rgba(0, 51, 102, 0.1);
        color: var(--nitap-blue);
      }

      .user-greeting {
        color: var(--nitap-blue);
        font-weight: 500;
        display: flex;
        align-items: center;
      }

      .user-greeting i {
        margin-right: 6px;
      }

      .form-container {
        background-color: white;
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        margin-bottom: 2rem;
      }

      .btn-primary {
        background-color: var(--nitap-blue);
        border-color: var(--nitap-blue);
      }

      .btn-primary:hover {
        background-color: #002244;
        border-color: #002244;
      }

      .card {
        border: none;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .table {
        background-color: white;
        border-radius: 8px;
        overflow: hidden;
      }

      .table th {
        background-color: var(--nitap-blue);
        color: white;
        font-weight: 500;
      }

      .status-badge {
        padding: 0.35em 0.65em;
        border-radius: 50rem;
        font-size: 0.875em;
        font-weight: 600;
      }

      .status-pending {
        background-color: #fff3cd;
        color: #856404;
      }

      .status-approved {
        background-color: #d4edda;
        color: #155724;
      }

      .status-rejected {
        background-color: #f8d7da;
        color: #721c24;
      }

      .alert {
        border-radius: 8px;
      }

      .input-group-text {
        background-color: var(--nitap-light);
      }

      .form-control:focus,
      .form-select:focus {
        border-color: var(--nitap-blue);
        box-shadow: 0 0 0 0.25rem rgba(0, 51, 102, 0.25);
      }

      .btn-link {
        text-decoration: none;
        color: var(--nitap-blue);
        padding-left: 0;
      }

      .btn-link:hover {
        text-decoration: underline;
      }

      .iframe-container {
        height: 600px;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        margin-bottom: 1.5rem;
      }

      .iframe-container iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
    </style>
  </head>
  <body>
    <div class="header text-center">
      <h1>National Institute of Technology, Andhra Pradesh</h1>
      <h2>Training & Placement Portal</h2>
    </div>
    <!-- navbar -->

    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
      <div class="container">
        <a class="navbar-brand" href="#">
          <img
            src="{% static 'images/nit.jpg' %}"
            alt="NITAP Logo"
            height="40"
          />
          T&P Cell
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarContent"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarContent">
          <!-- Left side items -->
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a
                class="nav-link {% if request.path == '/' %}active{% endif %}"
                href="{% url 'navigatetoindex' %}"
              >
                <i class="fas fa-home"></i> Home
              </a>
            </li>
            <!-- <li class="nav-item">
              <a
                class="nav-link {% if 'home_page_view' in request.path %}active{% endif %}"
                href="home_page_view"
              >
                <i class="fas fa-database"></i> Data Query
              </a>
            </li> -->
            {% if user.is_authenticated  %}
            <li class="nav-item">
              <a
                class="nav-link {% if 'verifystudents' in request.path %}active{% endif %}"
                href="{% url 'verifystudents' %}"
              >
                <i class="fas fa-user-check"></i> Verify Students
              </a>
            </li>
            {%if not branch%}
            <li class="nav-item">
              <a
                class="nav-link {% if 'updatestudentplacement' in request.path %}active{% endif %}"
                href="updatestudentplacement"
              >
                <i class="fas fa-user-edit"></i> Update Placement
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link {% if 'updatestudentplacement' in request.path %}active{% endif %}"
                href="../assignstudentcoordinator"
              >
                <i class="fas fa-user-edit"></i> Assign Student Coordinator
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link {% if 'updatestudentplacement' in request.path %}active{% endif %}"
                href="addannouncements"
              >
                <i class="fas fa-bullhorn"></i> Add Announcements
              </a>
            </li>
            {%endif%}
            {% endif %}
          </ul>

          <!-- Right side items -->
          <ul class="navbar-nav">
            {% if user.is_authenticated %}
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
              >
                <i class="fas fa-user-circle"></i> {{user.first_name}}
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <!-- <li>
                  <a class="dropdown-item" href="#"
                    ><i class="fas fa-user"></i> Profile</a
                  >
                </li> -->
                <!-- <li>
                  <a class="dropdown-item" href="#"
                    ><i class="fas fa-cog"></i> Settings</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li> -->
                  <a class="dropdown-item" href="logout"
                    ><i class="fas fa-sign-out-alt"></i> Logout</a
                  >
                </li>
              </ul>
            </li>
            {% else %}
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
              >
                <i class="fas fa-sign-in-alt"></i> Login
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li>
                  <a class="dropdown-item" href="login"
                    ><i class="fas fa-user-graduate"></i> Student Login</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="tplogin"
                    ><i class="fas fa-user-tie"></i> T&P Login</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="register"
                    ><i class="fas fa-user-plus"></i> Register</a
                  >
                </li>
              </ul>
            </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>
    <div class="container my-4">
      {%for mssg in messages%}
      <div
        class="alert alert-{{ mssg.tags }} alert-dismissible fade show"
        role="alert"
      >
        {{ mssg }}
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
        ></button>
      </div>
      {%endfor%}
      <h4 class="mb-4">
        <i class="fas fa-clock me-2 text-secondary"></i>{{pendingStudents}}
        Students yet to be verified
      </h4>
      <!-- filter -->
      {%if not data and not branch%}
      <div class="form-container">
        <h4 class="mb-4"><i class="fas fa-filter me-2"></i>Filter Students</h4>
        <form action="verifystudents" method="POST">
          {%csrf_token%}
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Select Branch</label>
              <select class="form-select" name="branch1">
                <option value="nil">Choose branch...</option>
                <option value="BIO">BioTechnology</option>
                <option value="CHE">Chemical Engineering</option>
                <option value="CIV">Civil Engineering</option>
                <option value="CSE">Computer Science and Engineering</option>
                <option value="EEE">
                  Electrical and Electronics Engineering
                </option>
                <option value="ECE">
                  Electronics and Communication Engineering
                </option>
                <option value="MEC">Mechanical Engineering</option>
                <option value="MME">
                  Metallurgical and Materials Engineering
                </option>
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Or enter Roll Number</label>
              <div class="input-group">
                <span class="input-group-text"
                  ><i class="fas fa-id-card"></i
                ></span>
                <input
                  type="text"
                  class="form-control"
                  name="rollNumber"
                  placeholder="Enter roll number"
                />
              </div>
            </div>
          </div>
          <div class="text-center">
            <button type="submit" class="btn btn-primary px-4">Search</button>
          </div>
        </form>
      </div>
      {%endif%}

      <!-- select student -->
      {%if students %}
      <div class="form-container">
        <h4 class="mb-4"><i class="fas fa-users me-2"></i>Select Student</h4>
        <form action="{% url 'verifystudents' %}" method="POST">
          {%csrf_token%}
          <input hidden name="button" />
          <div class="list-group">
            {% for student in students %}
            <button
              type="submit"
              class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
              name="rollNumber"
              value="{{student.roll_no}}"
            >
              <div><strong>{{student.roll_no}}</strong> - {{student.name}}</div>
              <span class="badge bg-primary rounded-pill"
                >{{student.branch}}</span
              >
            </button>
            {%endfor%}
          </div>
        </form>
      </div>
      {%endif%}

      <!-- student details -->
      {% if data and not students %}
      <div class="card mb-4">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">
            <i class="fas fa-user-graduate me-2"></i> Student Verification
          </h4>
        </div>
        <div class="row g-0">
          <div class="col-lg-4">
            <div class="card-body">
              <h5 class="card-title">
                <i class="fas fa-info-circle me-2"></i>Student Details
              </h5>
              <table class="table table-borderless">
                <tr>
                  <th>Name</th>
                  <td>{{ student.name }}</td>
                </tr>
                <tr>
                  <th>Roll No</th>
                  <td>{{ student.roll_no }}</td>
                </tr>
                <tr>
                  <th>Branch</th>
                  <td>{{ student.branch }}</td>
                </tr>
                <tr>
                  <th>Email</th>
                  <td>{{ student.email }}</td>
                </tr>
                <tr>
                  <th>Passing Year</th>
                  <td>{{ student.academic_year }}</td>
                </tr>
                <tr>
                  <th>Mobile</th>
                  <td>{{ student.mobile }}</td>
                </tr>
                <tr>
                  <th>CGPA</th>
                  <td>{{ student.cgpa }}</td>
                </tr>
                <tr>
                  <th>GATE Rank</th>
                  <td>{{ student.gate_rank }}</td>
                </tr>
                <tr>
                  <th>Backlogs</th>
                  <td>{{ student.backlogs }}</td>
                </tr>
                <tr>
                  <th>Interest</th>
                  <td>{{ student.job_type }}</td>
                </tr>
                <tr>
                  <th>Placed</th>
                  <td>
                    <span
                      class="badge {% if student.placed == 'Yes' %}bg-success{% else %}bg-secondary{% endif %}"
                    >
                      {{ student.placed }}
                    </span>
                  </td>
                </tr>
                <tr>
                  <th>LinkedIn</th>
                  <td>
                    {% if student.linkedin %}
                    <a
                      href="{{ student.linkedin }}"
                      target="_blank"
                      class="text-decoration-none"
                    >
                      <i class="fab fa-linkedin me-1"></i> View Profile
                    </a>
                    {% else %}N/A{% endif %}
                  </td>
                </tr>
                <tr>
                  <th>Registered</th>
                  <td>
                    <span
                      class="badge {% if student.registered == 'Yes' %}bg-success{% else %}bg-secondary{% endif %}"
                    >
                      {{ student.registered }}
                    </span>
                  </td>
                </tr>
                <tr>
                  <th>Verified</th>
                  <td>
                    <span
                      class="badge {% if student.verified == 'Yes' %}bg-success{% else %}bg-warning text-dark{% endif %}"
                    >
                      {{ student.verified }}
                    </span>
                  </td>
                </tr>
              </table>
              <p class="text-muted small">
                <i class="fas fa-clock me-1"></i> Last updated
                {{user.date_joined}}
              </p>
            </div>
          </div>
          <div class="col-lg-8">
            <div class="card-body">
              <h5 class="card-title">
                <i class="fas fa-clipboard-check me-2"></i>Verification Form
              </h5>
              <form action="verifystudents" method="POST">
                {%csrf_token%}
                <input
                  type="hidden"
                  name="rollno"
                  value="{{student.roll_no}}"
                />

                <div class="row mb-3">
                  <div class="col-md-6">
                    <label class="form-label">CGPA Validation</label>
                    <select required class="form-select" name="cgpa">
                      <option value="">Select status...</option>
                      <option value="CGPA is Valid">Valid</option>
                      <option value="CGPA is Invalid">Invalid</option>
                    </select>
                  </div>
                </div>
                {% if docs.results %}
                <div class="iframe-container">
                  <iframe
                    src="https://docs.google.com/gview?url={{docs.results}}&embedded=true"
                  ></iframe>
                </div>
                {% endif %}
                <div class="row mb-3">
                  <div class="col-md-6">
                    <label class="form-label">GATE Rank Validation</label>
                    <select required class="form-select" name="gate">
                      <option value="">Select status...</option>
                      <option value="Gate Rank is Valid">Valid</option>
                      <option value="Gate Rank is Invalid">Invalid</option>
                    </select>
                  </div>
                </div>
                {% if docs.scorecard %}
                <div class="iframe-container">
                  <iframe
                    src="https://docs.google.com/gview?url={{docs.scorecard}}&embedded=true"
                  ></iframe>
                </div>
                {% endif %}
                <div class="row mb-3">
                  <div class="col-md-6">
                    <label class="form-label">Backlogs Validation</label>
                    <select required class="form-select" name="backlogs">
                      <option value="">Select status...</option>
                      <option value="No of Backlogs are Valid">Valid</option>
                      <option value="No of Backlogs are Invalid">
                        Invalid
                      </option>
                    </select>
                  </div>
                </div>
                <div class="row mb-3">
                  <div class="col-md-6">
                    <label class="form-label">LinkedIn Validation</label>
                    <select required class="form-select" name="linkedin">
                      <option value="">Select status...</option>
                      <option value="Linkedin Profile is Valid">Valid</option>
                      <option value="Linkedin Profile is Invalid">
                        Invalid
                      </option>
                    </select>
                  </div>
                </div>

                <div class="form-check mb-4">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="verifyCheck"
                    name="verify"
                    value="Yes"
                  />
                  <label class="form-check-label" for="verifyCheck">
                    <strong>Mark student as verified</strong>
                  </label>
                </div>

                <div class="d-grid">
                  <button type="submit" class="btn btn-primary">
                    Submit Verification
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      {%endif%}
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
